<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=1200">
<title>Harga Jual â€” CV Mestika Lestari</title>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
*{
  box-sizing:border-box;
  font-family:"Segoe UI",Arial,sans-serif;
}

body{
  margin:0;
  background:#f4f7f6;
}

/* HEADER */
header{
  background:#2e7d32;
  color:#fff;
  padding:20px;
  display:flex;
  align-items:center;
  gap:15px;
}

header img{height:48px}
header h1{margin:0;font-size:22px}

/* CONTAINER (FIX WIDTH) */
.container{
  width:1200px;
  margin:25px auto;
}

/* CARD */
.card{
  background:#fff;
  border-radius:12px;
  padding:20px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
  margin-bottom:20px;
}

.card h2{margin-top:0;color:#2e7d32}

/* SEARCH */
.search-box{
  margin-bottom:12px;
}

.search-box input{
  width:100%;
  padding:10px;
  border-radius:6px;
  border:1px solid #ccc;
}

/* ACTION */
.action{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-bottom:10px;
}

button{
  padding:10px 18px;
  background:#2e7d32;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

/* TABLE */
.table-wrap{
  overflow-x:auto;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

th,td{
  border:1px solid #ccc;
  padding:9px;
}

th{
  background:#e8f5e9;
  text-align:center;
}

/* ROW MARKER */
tbody tr{
  border-left:6px solid transparent;
  transition:.15s;
}

tbody tr:nth-child(even){
  background:#f9fdf9;
}

tbody tr:hover{
  background:#e8f5e9;
  border-left:6px solid #2e7d32;
}

td.harga{
  text-align:right;
  font-weight:bold;
}

/* FOOTER */
footer{
  text-align:center;
  font-size:13px;
  color:#777;
  padding:15px;
}

/* PRINT */
@media print{
  @page{
    size:A4 landscape;
    margin:12mm;
  }

  header,
  .search-box,
  .action,
  footer{
    display:none !important;
  }

  .container{
    width:100%;
  }

  .card{
    box-shadow:none;
    padding:0;
  }

  table{font-size:11px}
  th,td{border:1px solid #000}
}
</style>
</head>

<body>

<header>
  
  <h1>Harga Jual Produk â€” CV Mestika Lestari</h1>
</header>

<div class="container">

  <div class="card">
    <h2>Daftar Harga Jual</h2>

    <!-- SEARCH -->
    <div class="search-box">
      <input id="searchInput" placeholder="Cari kode, nama barang, kemasan..." onkeyup="filterData()">
    </div>

    <!-- ACTION -->
    <div class="action">
      <button onclick="window.print()">ðŸ–¨ Print</button>
      <button onclick="exportPDF()">ðŸ“„ PDF</button>
    </div>

    <!-- TABLE -->
    <div class="table-wrap">
      <table>
        <thead id="thead"></thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

</div>

<footer>Â© CV Mestika Lestari</footer>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbwQE7aNWjMTygxHXwvrrYBPINKDBDSqX0O4GsIe3X1ZaprVC4qX-lmdrUpcW91nbLKu/exec";
let dataHarga=[];

/* HELPER */
function rupiah(n){
  if(!n) return "";
  return "Rp "+Number(n).toLocaleString("id-ID");
}

/* LOAD */
async function loadData(){
  const res=await fetch(API_URL);
  dataHarga=await res.json();
  render(dataHarga);
}

/* RENDER */
function render(data){
  if(!data.length){
    tbody.innerHTML="<tr><td align='center'>Belum ada data</td></tr>";
    return;
  }

  const headers=Object.keys(data[0]);
  thead.innerHTML="<tr>"+headers.map(h=>`<th>${h}</th>`).join("")+"</tr>";

  tbody.innerHTML=data.map(r=>{
    return "<tr>"+headers.map(h=>{
      if(h.toLowerCase().includes("harga"))
        return `<td class="harga">${rupiah(r[h])}</td>`;
      return `<td>${r[h] ?? ""}</td>`;
    }).join("")+"</tr>";
  }).join("");
}

/* SEARCH */
function filterData(){
  const k=searchInput.value.toLowerCase();
  render(
    dataHarga.filter(r=>
      Object.values(r).join(" ").toLowerCase().includes(k)
    )
  );
}

/* PDF LANDSCAPE */
async function exportPDF(){
  const {jsPDF}=window.jspdf;
  const canvas=await html2canvas(document.body,{scale:2});
  const img=canvas.toDataURL("image/png");
  const pdf=new jsPDF("landscape","mm","a4");
  const w=pdf.internal.pageSize.getWidth();
  const h=canvas.height*w/canvas.width;
  pdf.addImage(img,"PNG",0,10,w,h);
  pdf.save("Harga_Jual_CV_Mestika_Lestari.pdf");
}

loadData();
</script>

</body>
</html>
