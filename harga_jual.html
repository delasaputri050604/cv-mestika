<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Harga Jual ‚Äî CV Mestika Lestari</title>

<style>
*{
  box-sizing:border-box;
  font-family: "Segoe UI", Arial, sans-serif;
}

body{
  margin:0;
  background:#f4f7f6;
  color:#111;
}

/* ===== HEADER ===== */
header{
  background:#2e7d32;
  color:#fff;
  padding:20px;
  display:flex;
  align-items:center;
  gap:15px;
}

header img{
  height:48px;
}

header h1{
  font-size:22px;
  margin:0;
}

/* ===== CONTAINER ===== */
.container{
  width:95%;
  max-width:1200px;
  margin:25px auto;
}

/* ===== CARD ===== */
.card{
  background:#fff;
  border-radius:12px;
  padding:20px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
  margin-bottom:25px;
}

.card h2{
  margin-top:0;
  color:#2e7d32;
}

/* ===== FORM ===== */
.form-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:12px;
}

input{
  padding:10px;
  border:1px solid #ccc;
  border-radius:6px;
}

button{
  margin-top:15px;
  padding:12px;
  background:#2e7d32;
  color:#fff;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

button:hover{
  background:#1b5e20;
}

.print-area{
  display:flex;
  justify-content:flex-end;
  margin-bottom:10px;
}

.print-btn{
  padding:10px 16px;
  background:#2e7d32;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
}

/* ===== TABLE ===== */
table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

th,td{
  border:1px solid #ccc;
  padding:8px;
}

th{
  background:#e8f5e9;
  text-align:center;
}

td.harga{
  text-align:right;
  font-weight:bold;
}

/* ===== FOOTER ===== */
footer{
  text-align:center;
  padding:15px;
  font-size:13px;
  color:#777;
}

/* ===== PRINT MODE ===== */
@media print{

  @page{
    size:A4 portrait;
    margin:12mm;
  }

  body{
    background:#fff;
  }

  header,
  .form-card,
  footer,
  .print-area{
    display:none !important;
  }

  .card{
    box-shadow:none !important;
    padding:0;
    margin:0;
  }

  table{
    font-size:11px;
  }

  th,td{
    border:1px solid #000 !important;
    padding:6px;
  }

  th{
    background:#fff !important;
    font-weight:bold;
  }

  tr{
    page-break-inside:avoid;
  }
}
</style>
</head>

<body>

<header>
  <img src="https://upload.wikimedia.org/wikipedia/commons/3/3f/Logo_placeholder.png">
  <h1>Harga Jual Produk ‚Äî CV Mestika Lestari</h1>
</header>

<div class="container">

  <!-- FORM INPUT (TIDAK IKUT PRINT) -->
  <div class="card form-card">
    <h2>Input Harga Jual</h2>
    <div class="form-grid">
      <input id="kode" placeholder="Kode Barang">
      <input id="nama" placeholder="Nama Barang">
      <input id="kemasan" placeholder="Jenis Kemasan">
      <input id="harga" type="number" placeholder="Harga Jual">
      <input id="satuan" placeholder="Satuan">
    </div>
    <button onclick="simpanData()">üíæ Simpan Harga</button>
    <div id="info"></div>
  </div>

  <!-- TABEL DATA (IKUT PRINT) -->
  <div class="card">
    <div class="print-area">
      <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print Disini</button>
    </div>

    <h2>Daftar Harga Jual</h2>
    <table>
      <thead id="thead"></thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

</div>

<footer>
  ¬© CV Mestika Lestari
</footer>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwQE7aNWjMTygxHXwvrrYBPINKDBDSqX0O4GsIe3X1ZaprVC4qX-lmdrUpcW91nbLKu/exec";

/* LOAD DATA */
async function loadData(){
  const res = await fetch(API_URL);
  const data = await res.json();

  if(!data.length){
    tbody.innerHTML = "<tr><td colspan='6' align='center'>Belum ada data</td></tr>";
    return;
  }

  const headers = Object.keys(data[0]);
  thead.innerHTML = "<tr>"+headers.map(h=>`<th>${h}</th>`).join("")+"</tr>";

  tbody.innerHTML = data.map(r=>{
    return "<tr>"+headers.map(h=>{
      if(h.toLowerCase().includes("harga")){
        return `<td class="harga">Rp ${Number(r[h]).toLocaleString("id-ID")}</td>`;
      }
      return `<td>${r[h] ?? ""}</td>`;
    }).join("")+"</tr>";
  }).join("");
}

/* SIMPAN */
async function simpanData(){
  const payload = {
    "KODE BARANG": kode.value,
    "NAMA BARANG": nama.value,
    "JENIS KEMASAN": kemasan.value,
    "HARGA JUAL": harga.value,
    "SATUAN": satuan.value
  };

  info.innerText="Menyimpan...";

  const res = await fetch(API_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify(payload)
  });

  const r = await res.json();
  if(r.status==="success"){
    info.innerText="‚úÖ Data tersimpan";
    kode.value=nama.value=kemasan.value=harga.value=satuan.value="";
    loadData();
  }else{
    info.innerText="‚ùå Gagal simpan";
  }
}

loadData();
</script>

</body>
</html>
