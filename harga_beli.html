<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">

<!-- VIEWPORT DIKUNCI (ANTI AMBURADUL HP) -->
<meta name="viewport" content="width=1200">

<title>Harga Beli Supplier â€” CV Mestika Lestari</title>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
*{
  box-sizing:border-box;
  font-family:Segoe UI,Arial,sans-serif;
}

body{
  margin:0;
  background:#f4f6f8;
}

/* ===== HEADER ===== */
header{
  background:linear-gradient(135deg,#1b5e20,#2e7d32);
  color:#fff;
  padding:22px;
  font-size:22px;
  font-weight:bold;
  text-align:center;
}

/* ===== CONTAINER FIXED ===== */
.container{
  width:1200px;
  margin:20px auto;
}

/* ===== CARD ===== */
.card{
  background:#fff;
  border-radius:12px;
  padding:20px;
  box-shadow:0 6px 15px rgba(0,0,0,.1);
}

/* ===== TOP ACTION ===== */
.top-action{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}

.search-box input{
  width:320px;
  padding:10px;
  border-radius:8px;
  border:1px solid #ccc;
}

button{
  padding:10px 16px;
  border:none;
  border-radius:6px;
  background:#2e7d32;
  color:#fff;
  cursor:pointer;
}

/* ===== TABLE ===== */
.table-wrap{
  overflow:hidden;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

th,td{
  border:1px solid #ccc;
  padding:8px 10px;
  white-space:nowrap;
}

th{
  background:#e8f5e9;
  text-align:center;
}

/* ZEBRA */
tbody tr:nth-child(even){
  background:#f1f8e9;
}
tbody tr:hover{
  background:#e0f2f1;
}

/* ===== COLUMN SIZE ===== */
.col-no{width:60px;text-align:center}
.col-kode{width:120px}
.col-supplier{width:160px}   /* DIPERSEMPIT */
.col-isi{width:220px}        /* DIPERBESAR */
.col-harga{width:150px;text-align:right;font-weight:bold}

/* ===== FOOTER ===== */
.footer{
  text-align:center;
  margin-top:20px;
  font-size:13px;
  color:#777;
}

/* ===== PRINT LANDSCAPE ===== */
@media print{
  @page{
    size:A4 landscape;
    margin:12mm;
  }
  header,.top-action,.footer{display:none}
  body{background:#fff}
  .card{box-shadow:none;padding:0}
  table{font-size:11px}
  th,td{border:1px solid #000}
  tr{page-break-inside:avoid}
}
</style>
</head>

<body>

<header>
  ðŸ“¦ HARGA BELI SUPPLIER â€” CV MESTIKA LESTARI
</header>

<div class="container">

  <div class="card">

    <div class="top-action">
      <div class="search-box">
        <input id="search" placeholder="Cari barang / supplier...">
      </div>
      <div>
        <button onclick="window.print()">ðŸ–¨ Print</button>
        <button onclick="exportPDF()">ðŸ“„ PDF</button>
      </div>
    </div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th class="col-no">NO</th>
            <th class="col-kode">KODE</th>
            <th>NAMA BARANG</th>
            <th class="col-supplier">SUPPLIER</th>
            <th>KEMASAN</th>
            <th class="col-harga">HARGA</th>
            <th class="col-isi">ISI</th>
          </tr>
        </thead>
        <tbody id="tbody">
          <tr><td colspan="7" align="center">Loading...</td></tr>
        </tbody>
      </table>
    </div>

  </div>

  <div class="footer">Â© CV Mestika Lestari</div>
</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbyqQtD1qH4DXLHE03frW7BAl8iUkAwXewFm9PjQoXmaXS0iAergnuYVb1F_3BY7O5HF/exec";
let allData=[];

function rupiah(n){
  return "Rp "+Number(n||0).toLocaleString("id-ID");
}

async function loadData(){
  const res=await fetch(API_URL);
  allData=await res.json();
  render(allData);
}

function render(data){
  const tb=document.getElementById("tbody");
  tb.innerHTML="";
  if(!data.length){
    tb.innerHTML="<tr><td colspan='7' align='center'>Data tidak ditemukan</td></tr>";
    return;
  }
  data.forEach(r=>{
    tb.innerHTML+=`
    <tr>
      <td class="col-no">${r["NO"]||""}</td>
      <td class="col-kode">${r["KODE BARANG"]||""}</td>
      <td>${r["NAMA BARANG"]||""}</td>
      <td class="col-supplier">${r["SUPPLIER"]||""}</td>
      <td>${r["JENIS KEMASAN"]||""}</td>
      <td class="col-harga">${rupiah(r["HARGA SATUAN"])}</td>
      <td class="col-isi">${r["ISI/SATUAN"]||""}</td>
    </tr>`;
  });
}

document.getElementById("search").addEventListener("input",e=>{
  const k=e.target.value.toLowerCase();
  render(allData.filter(x=>
    x["NAMA BARANG"].toLowerCase().includes(k) ||
    x["SUPPLIER"].toLowerCase().includes(k)
  ));
});

/* PDF LANDSCAPE */
async function exportPDF(){
  const {jsPDF}=window.jspdf;
  const canvas=await html2canvas(document.body);
  const img=canvas.toDataURL("image/png");
  const pdf=new jsPDF("landscape","mm","a4");
  const w=pdf.internal.pageSize.getWidth();
  const h=canvas.height*w/canvas.width;
  pdf.addImage(img,"PNG",0,10,w,h);
  pdf.save("Harga_Beli_CV_Mestika_Lestari.pdf");
}

loadData();
</script>

</body>
</html>
